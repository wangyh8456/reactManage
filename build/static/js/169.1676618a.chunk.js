"use strict";(self.webpackChunklayout=self.webpackChunklayout||[]).push([[169],{3169:function(e,n,t){t.r(n),t.d(n,{default:function(){return O}});t(1562);var r=t(7083),a=(t(267),t(2503)),s=(t(6773),t(4317)),o=(t(6885),t(6366)),c=(t(8308),t(135)),l=(t(224),t(3695)),i=t(5861),u=(t(65),t(2085)),d=(t(965),t(3099)),p=(t(5819),t(7309)),f=(t(5987),t(7528)),m=t(9439),h=(t(798),t(5500)),Z=t(7757),x=t.n(Z),y=t(2791),v=t(8882),g=t(5796),b=t(9286),j=t(1413),k=(t(4155),t(5581)),C=t(184);function w(e){var n=u.Z.useForm(),t=(0,m.Z)(n,1)[0],r=e.current,a=null===r||void 0===r?void 0:r.id;function s(){return(s=(0,i.Z)(x().mark((function n(t){var s,o,c;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s={username:t.username,name:t.name,phone:t.phone,roles:JSON.stringify(t.roles)},!a){n.next=8;break}return o=(0,j.Z)((0,j.Z)({},s),{},{status:t.status?1:0,id:r.id}),n.next=5,v.Nq(o);case 5:c=n.sent,n.next=12;break;case 8:return o=(0,j.Z)((0,j.Z)({},s),{},{password:t.password}),n.next=11,v.cn(o);case 11:c=n.sent;case 12:200===c.status?(l.ZP.success({content:c.message,duration:2}),e.close(),e.getList()):l.ZP.error({content:c.message,duration:2});case 13:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return y.useEffect((function(){!function(){if(null!==r&&void 0!==r&&r.id&&(t.setFieldsValue({name:r.name,username:r.username,phone:r.phone,status:r.status}),r.roles)){var n=JSON.parse(r.roles);n=n.filter((function(n){return e.roleList.find((function(e){return e.value===n}))})),t.setFieldsValue({roles:n})}}()}),[]),(0,C.jsxs)(u.Z,{layout:"vertical",form:t,name:"modalform",onFinish:function(e){return s.apply(this,arguments)},onFinishFailed:function(e){console.log(e)},children:[(0,C.jsx)(u.Z.Item,{name:"username",label:"\u7528\u6237\u540d",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d!"},{type:"string",max:16,message:"\u7528\u6237\u540d\u4e3a\u4e0d\u8d85\u8fc716\u4f4d\u7684\u5b57\u7b26\u4e32"}],hasFeedback:!0,children:(0,C.jsx)(c.Z,{})}),(0,C.jsx)(u.Z.Item,{name:"password",label:"\u5bc6\u7801",hidden:a,rules:a?[]:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"},{type:"string",max:16,message:"\u5bc6\u7801\u4e3a\u4e0d\u8d85\u8fc716\u4f4d\u7684\u5b57\u7b26\u4e32"}],hasFeedback:!0,children:(0,C.jsx)(c.Z.Password,{})}),(0,C.jsx)(u.Z.Item,{name:"repassword",label:"\u786e\u8ba4\u5bc6\u7801",dependencies:["password"],hasFeedback:!0,hidden:a,rules:a?[]:[{required:!0,message:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801!"},function(e){var n=e.getFieldValue;return{validator:function(e,t){return t&&n("password")!==t?Promise.reject(new Error("\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4!")):Promise.resolve()}}}],children:(0,C.jsx)(c.Z.Password,{})}),(0,C.jsx)(u.Z.Item,{name:"name",label:"\u59d3\u540d",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u59d3\u540d!"}],hasFeedback:!0,children:(0,C.jsx)(c.Z,{})}),(0,C.jsx)(u.Z.Item,{name:"phone",label:"\u7535\u8bdd",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7535\u8bdd!"},{pattern:/^1[345789]\d{9}$/,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7!"}],hasFeedback:!0,children:(0,C.jsx)(c.Z,{})}),(0,C.jsx)(u.Z.Item,{name:"roles",label:"\u89d2\u8272",children:(0,C.jsx)(o.Z,{mode:"multiple",placeholder:"-\u8bf7\u9009\u62e9-",options:e.roleList})}),(0,C.jsx)(u.Z.Item,{name:"status",label:"\u5e10\u53f7\u72b6\u6001",valuePropName:"checked",hidden:!a,children:(0,C.jsx)(k.Z,{})}),(0,C.jsxs)(u.Z.Item,{style:{textAlign:"center"},children:[(0,C.jsx)(p.Z,{style:{marginRight:"30px"},onClick:function(){t.resetFields()},children:"\u91cd\u7f6e"}),(0,C.jsx)(p.Z,{type:"primary",htmlType:"submit",children:"\u786e\u8ba4"})]})]})}var S=h.Z.confirm;function O(){var e=(0,y.useState)([]),n=(0,m.Z)(e,2),t=n[0],Z=n[1],j=(0,y.useState)(5),k=(0,m.Z)(j,2),O=k[0],E=k[1],I=(0,y.useState)(1),N=(0,m.Z)(I,2),P=N[0],F=N[1],z=(0,y.useState)(0),T=(0,m.Z)(z,2),R=T[0],q=T[1],L=(0,y.useState)(!1),_=(0,m.Z)(L,2),J=_[0],K=_[1],V=(0,y.useState)(""),D=(0,m.Z)(V,2),H=D[0],$=D[1],A=(0,y.useState)(""),Y=(0,m.Z)(A,2),B=Y[0],G=Y[1],Q=(0,y.useState)(""),U=(0,m.Z)(Q,2),W=U[0],M=U[1],X=(0,y.useState)(""),ee=(0,m.Z)(X,2),ne=ee[0],te=ee[1],re=(0,y.useState)(!1),ae=(0,m.Z)(re,2),se=ae[0],oe=ae[1],ce=(0,y.useState)([]),le=(0,m.Z)(ce,2),ie=le[0],ue=le[1],de=(0,y.useState)({}),pe=(0,m.Z)(de,2),fe=pe[0],me=pe[1],he=(0,y.useState)("\u65b0\u5efa\u7528\u6237"),Ze=(0,m.Z)(he,2),xe=Ze[0],ye=Ze[1],ve=[{title:"\u7528\u6237\u540d",dataIndex:"username",key:"username",render:function(e){return(0,C.jsx)(C.Fragment,{children:e})}},{title:"\u59d3\u540d",dataIndex:"name",key:"name"},{title:"\u7535\u8bdd",dataIndex:"phone",key:"phone",render:function(e){return(0,C.jsx)(C.Fragment,{children:e&&"undefined"!==e?e:"\u672a\u586b\u5199"})}},{title:"\u5e10\u53f7\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){var n="volcano",t="\u51bb\u7ed3";return 1===e&&(n="green",t="\u6b63\u5e38"),(0,C.jsx)(f.Z,{color:n,children:t},e)}},{title:"\u89d2\u8272",dataIndex:"roles",key:"roles",render:function(e){var n=e?JSON.parse(e):[],t=[];return n.forEach((function(e){var n=ie.find((function(n){return n.value===e}));null!==n&&void 0!==n&&n.label&&t.push(n.label)})),t.map((function(e,n){return(0,C.jsx)(f.Z,{color:"cyan",children:e},e+n)}))}},{title:"\u64cd\u4f5c",key:"action",render:function(e,n){return(0,C.jsxs)(d.Z,{size:"small",children:[(0,C.jsx)(p.Z,{onClick:function(){me(n),ye("\u7f16\u8f91\u7528\u6237"),oe(!0)},type:"primary",children:"\u7f16\u8f91"}),(0,C.jsx)(p.Z,{onClick:function(){var e;e=n.id,S({title:"\u5220\u9664\u7528\u6237",icon:(0,C.jsx)(g.Z,{}),content:"\u786e\u8ba4\u8981\u5220\u9664\u8be5\u7528\u6237\u5417\uff1f",onOk:function(){return(0,i.Z)(x().mark((function n(){var t;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.h8(e);case 2:200===(t=n.sent).status?(l.ZP.success({content:t.message,duration:2}),je()):l.ZP.error({content:t.message,duration:2});case 4:case"end":return n.stop()}}),n)})))()},onCancel:function(){console.log("Cancel")}})},type:"danger",children:"\u5220\u9664"})]})}}],ge=u.Z.useForm(),be=(0,m.Z)(ge,1)[0];function je(){return ke.apply(this,arguments)}function ke(){return(ke=(0,i.Z)(x().mark((function e(){var n,t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),n={username:B,name:W,phone:ne,status:H,pageSize:O,pageNum:P},e.next=4,v.lE(n);case 4:t=e.sent,Z(t.data.list),q(t.data.total),K(!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(){return(Ce=(0,i.Z)(x().mark((function e(n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(n.username),M(n.name),te(n.phone),$(n.status),F(1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(){return(we=(0,i.Z)(x().mark((function e(){var n,t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),e.next=3,v.Uj();case 3:n=e.sent,t=n.data?n.data:[],ue(t.map((function(e){return{label:e.name,value:e.id,status:e.status}}))),K(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,y.useEffect)((function(){console.log("render"),je()}),[O,P,B,ne,W,H]),(0,y.useEffect)((function(){!function(){we.apply(this,arguments)}()}),[]),(0,C.jsx)(r.Z,{spinning:J,size:"large",tip:"\u52a0\u8f7d\u4e2d......",children:(0,C.jsxs)("div",{className:"clearfix",children:[(0,C.jsx)(d.Z,{size:[8,16],wrap:!0,style:{marginBottom:"20px"},children:(0,C.jsx)(p.Z,{icon:(0,C.jsx)(b.Z,{}),type:"primary",onClick:function(){me({}),ye("\u65b0\u5efa\u7528\u6237"),oe(!0)},children:"\u65b0\u589e\u7528\u6237"})}),(0,C.jsx)(h.Z,{title:xe,visible:se,onCancel:function(){oe(!1)},bodyStyle:{maxHeight:"700px",overflowY:"auto"},footer:null,style:{top:"50px"},destroyOnClose:!0,children:(0,C.jsx)(w,{close:function(){oe(!1)},getList:function(){je()},current:fe,roleList:ie})}),(0,C.jsxs)(u.Z,{layout:"inline",form:be,onFinish:function(e){return Ce.apply(this,arguments)},children:[(0,C.jsx)(u.Z.Item,{name:"username",children:(0,C.jsx)(c.Z,{placeholder:"\u7528\u6237\u540d"})}),(0,C.jsx)(u.Z.Item,{name:"name",children:(0,C.jsx)(c.Z,{placeholder:"\u59d3\u540d"})}),(0,C.jsx)(u.Z.Item,{name:"phone",children:(0,C.jsx)(c.Z,{placeholder:"\u7535\u8bdd"})}),(0,C.jsx)(u.Z.Item,{name:"status",children:(0,C.jsx)(o.Z,{placeholder:"\u5e10\u53f7\u72b6\u6001",style:{width:"100px"},options:[{label:"\u6b63\u5e38",value:1},{label:"\u51bb\u7ed3",value:0}],allowClear:!0})}),(0,C.jsx)(u.Z.Item,{children:(0,C.jsx)(p.Z,{onClick:function(){be.resetFields()},children:"\u91cd\u7f6e"})}),(0,C.jsx)(u.Z.Item,{children:(0,C.jsx)(p.Z,{type:"primary",htmlType:"submit",children:"\u641c\u7d22"})})]}),(0,C.jsx)(s.Z,{columns:ve,dataSource:t,rowKey:"id",pagination:!1}),(0,C.jsx)(a.Z,{total:R,showTotal:function(e){return"\u5171".concat(e,"\u6761")},pageSize:O,current:P,pageSizeOptions:[5,10,20],showSizeChanger:!0,showQuickJumper:!1,onChange:function(e){F(e)},onShowSizeChange:function(e,n){F(e),E(n)},style:{float:"right",marginTop:"20px"}})]})})}},5581:function(e,n,t){t.d(n,{Z:function(){return b}});var r=t(7462),a=t(4942),s=t(2791),o=t(9439),c=t(4925),l=t(1694),i=t.n(l),u=t(5179),d=t(1354),p=s.forwardRef((function(e,n){var t,r=e.prefixCls,l=void 0===r?"rc-switch":r,p=e.className,f=e.checked,m=e.defaultChecked,h=e.disabled,Z=e.loadingIcon,x=e.checkedChildren,y=e.unCheckedChildren,v=e.onClick,g=e.onChange,b=e.onKeyDown,j=(0,c.Z)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),k=(0,u.Z)(!1,{value:f,defaultValue:m}),C=(0,o.Z)(k,2),w=C[0],S=C[1];function O(e,n){var t=w;return h||(S(t=e),null===g||void 0===g||g(t,n)),t}var E=i()(l,p,(t={},(0,a.Z)(t,"".concat(l,"-checked"),w),(0,a.Z)(t,"".concat(l,"-disabled"),h),t));return s.createElement("button",Object.assign({},j,{type:"button",role:"switch","aria-checked":w,disabled:h,className:E,ref:n,onKeyDown:function(e){e.which===d.Z.LEFT?O(!1,e):e.which===d.Z.RIGHT&&O(!0,e),null===b||void 0===b||b(e)},onClick:function(e){var n=O(!w,e);null===v||void 0===v||v(n,e)}}),Z,s.createElement("span",{className:"".concat(l,"-inner")},w?x:y))}));p.displayName="Switch";var f=p,m=t(7106),h=t(2833),Z=t(9077),x=t(1815),y=t(4824),v=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},g=s.forwardRef((function(e,n){var t,o=e.prefixCls,c=e.size,l=e.loading,u=e.className,d=void 0===u?"":u,p=e.disabled,g=v(e,["prefixCls","size","loading","className","disabled"]);(0,y.Z)("checked"in g||!("value"in g),"Switch","`value` is not a valid prop, do you mean `checked`?");var b=s.useContext(Z.E_),j=b.getPrefixCls,k=b.direction,C=s.useContext(x.Z),w=j("switch",o),S=s.createElement("div",{className:"".concat(w,"-handle")},l&&s.createElement(m.Z,{className:"".concat(w,"-loading-icon")})),O=i()((t={},(0,a.Z)(t,"".concat(w,"-small"),"small"===(c||C)),(0,a.Z)(t,"".concat(w,"-loading"),l),(0,a.Z)(t,"".concat(w,"-rtl"),"rtl"===k),t),d);return s.createElement(h.Z,{insertExtraNode:!0},s.createElement(f,(0,r.Z)({},g,{prefixCls:w,className:O,disabled:p||l,ref:n,loadingIcon:S})))}));g.__ANT_SWITCH=!0,g.displayName="Switch";var b=g},4155:function(e,n,t){t(8218)},7528:function(e,n,t){t.d(n,{Z:function(){return b}});var r=t(4942),a=t(7462),s=t(9439),o=t(2791),c=t(1694),l=t.n(c),i=t(1818),u=t(732),d=t(9077),p=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},f=function(e){var n,t=e.prefixCls,s=e.className,c=e.checked,i=e.onChange,u=e.onClick,f=p(e,["prefixCls","className","checked","onChange","onClick"]),m=(0,o.useContext(d.E_).getPrefixCls)("tag",t),h=l()(m,(n={},(0,r.Z)(n,"".concat(m,"-checkable"),!0),(0,r.Z)(n,"".concat(m,"-checkable-checked"),c),n),s);return o.createElement("span",(0,a.Z)({},f,{className:h,onClick:function(e){null===i||void 0===i||i(!c),null===u||void 0===u||u(e)}}))},m=t(4466),h=t(2833),Z=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},x=new RegExp("^(".concat(m.Y.join("|"),")(-inverse)?$")),y=new RegExp("^(".concat(m.E.join("|"),")$")),v=function(e,n){var t,c=e.prefixCls,p=e.className,f=e.style,m=e.children,v=e.icon,g=e.color,b=e.onClose,j=e.closeIcon,k=e.closable,C=void 0!==k&&k,w=Z(e,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),S=o.useContext(d.E_),O=S.getPrefixCls,E=S.direction,I=o.useState(!0),N=(0,s.Z)(I,2),P=N[0],F=N[1];o.useEffect((function(){"visible"in w&&F(w.visible)}),[w.visible]);var z=function(){return!!g&&(x.test(g)||y.test(g))},T=(0,a.Z)({backgroundColor:g&&!z()?g:void 0},f),R=z(),q=O("tag",c),L=l()(q,(t={},(0,r.Z)(t,"".concat(q,"-").concat(g),R),(0,r.Z)(t,"".concat(q,"-has-color"),g&&!R),(0,r.Z)(t,"".concat(q,"-hidden"),!P),(0,r.Z)(t,"".concat(q,"-rtl"),"rtl"===E),t),p),_=function(e){e.stopPropagation(),null===b||void 0===b||b(e),e.defaultPrevented||"visible"in w||F(!1)},J="onClick"in w||m&&"a"===m.type,K=(0,i.Z)(w,["visible"]),V=v||null,D=V?o.createElement(o.Fragment,null,V,o.createElement("span",null,m)):m,H=o.createElement("span",(0,a.Z)({},K,{ref:n,className:L,style:T}),D,C?j?o.createElement("span",{className:"".concat(q,"-close-icon"),onClick:_},j):o.createElement(u.Z,{className:"".concat(q,"-close-icon"),onClick:_}):null);return J?o.createElement(h.Z,null,H):H},g=o.forwardRef(v);g.displayName="Tag",g.CheckableTag=f;var b=g},5987:function(e,n,t){t(8218)}}]);
//# sourceMappingURL=169.1676618a.chunk.js.map